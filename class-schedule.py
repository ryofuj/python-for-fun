from itertools import combinations

class SchedulePlanner:
    def __init__(self):
        self.timetable = {
            'Monday': {'0000': 0, '0015': 0, '0030': 0, '0045': 0, '0100': 0, '0115': 0, '0130': 0, '0145': 0, '0200': 0, '0215': 0, '0230': 0, '0245': 0, '0300': 0, '0315': 0, '0330': 0, '0345': 0, '0400': 0, '0415': 0, '0430': 0, '0445': 0, '0500': 0, '0515': 0, '0530': 0, '0545': 0, '0600': 0, '0615': 0, '0630': 0, '0645': 0, '0700': 0, '0715': 0, '0730': 0, '0745': 0, '0800': 0, '0815': 0, '0830': 0, '0845': 0, '0900': 0, '0915': 0, '0930': 0, '0945': 0, '1000': 0, '1015': 0, '1030': 0, '1045': 0, '1100': 0, '1115': 0, '1130': 0, '1145': 0, '1200': 0, '1215': 0, '1230': 0, '1245': 0, '1300': 0, '1315': 0, '1330': 0, '1345': 0, '1400': 0, '1415': 0, '1430': 0, '1445': 0, '1500': 0, '1515': 0, '1530': 0, '1545': 0, '1600': 0, '1615': 0, '1630': 0, '1645': 0, '1700': 0, '1715': 0, '1730': 0, '1745': 0, '1800': 0, '1815': 0, '1830': 0, '1845': 0, '1900': 0, '1915': 0, '1930': 0, '1945': 0, '2000': 0, '2015': 0, '2030': 0, '2045': 0, '2100': 0, '2115': 0, '2130': 0, '2145': 0, '2200': 0, '2215': 0, '2230': 0, '2245': 0, '2300': 0, '2315': 0, '2330': 0, '2345': 0},
            'Tuesday': {'0000': 0, '0015': 0, '0030': 0, '0045': 0, '0100': 0, '0115': 0, '0130': 0, '0145': 0, '0200': 0, '0215': 0, '0230': 0, '0245': 0, '0300': 0, '0315': 0, '0330': 0, '0345': 0, '0400': 0, '0415': 0, '0430': 0, '0445': 0, '0500': 0, '0515': 0, '0530': 0, '0545': 0, '0600': 0, '0615': 0, '0630': 0, '0645': 0, '0700': 0, '0715': 0, '0730': 0, '0745': 0, '0800': 0, '0815': 0, '0830': 0, '0845': 0, '0900': 0, '0915': 0, '0930': 0, '0945': 0, '1000': 0, '1015': 0, '1030': 0, '1045': 0, '1100': 0, '1115': 0, '1130': 0, '1145': 0, '1200': 0, '1215': 0, '1230': 0, '1245': 0, '1300': 0, '1315': 0, '1330': 0, '1345': 0, '1400': 0, '1415': 0, '1430': 0, '1445': 0, '1500': 0, '1515': 0, '1530': 0, '1545': 0, '1600': 0, '1615': 0, '1630': 0, '1645': 0, '1700': 0, '1715': 0, '1730': 0, '1745': 0, '1800': 0, '1815': 0, '1830': 0, '1845': 0, '1900': 0, '1915': 0, '1930': 0, '1945': 0, '2000': 0, '2015': 0, '2030': 0, '2045': 0, '2100': 0, '2115': 0, '2130': 0, '2145': 0, '2200': 0, '2215': 0, '2230': 0, '2245': 0, '2300': 0, '2315': 0, '2330': 0, '2345': 0},
            'Wednesday': {'0000': 0, '0015': 0, '0030': 0, '0045': 0, '0100': 0, '0115': 0, '0130': 0, '0145': 0, '0200': 0, '0215': 0, '0230': 0, '0245': 0, '0300': 0, '0315': 0, '0330': 0, '0345': 0, '0400': 0, '0415': 0, '0430': 0, '0445': 0, '0500': 0, '0515': 0, '0530': 0, '0545': 0, '0600': 0, '0615': 0, '0630': 0, '0645': 0, '0700': 0, '0715': 0, '0730': 0, '0745': 0, '0800': 0, '0815': 0, '0830': 0, '0845': 0, '0900': 0, '0915': 0, '0930': 0, '0945': 0, '1000': 0, '1015': 0, '1030': 0, '1045': 0, '1100': 0, '1115': 0, '1130': 0, '1145': 0, '1200': 0, '1215': 0, '1230': 0, '1245': 0, '1300': 0, '1315': 0, '1330': 0, '1345': 0, '1400': 0, '1415': 0, '1430': 0, '1445': 0, '1500': 0, '1515': 0, '1530': 0, '1545': 0, '1600': 0, '1615': 0, '1630': 0, '1645': 0, '1700': 0, '1715': 0, '1730': 0, '1745': 0, '1800': 0, '1815': 0, '1830': 0, '1845': 0, '1900': 0, '1915': 0, '1930': 0, '1945': 0, '2000': 0, '2015': 0, '2030': 0, '2045': 0, '2100': 0, '2115': 0, '2130': 0, '2145': 0, '2200': 0, '2215': 0, '2230': 0, '2245': 0, '2300': 0, '2315': 0, '2330': 0, '2345': 0},
            'Thursday': {'0000': 0, '0015': 0, '0030': 0, '0045': 0, '0100': 0, '0115': 0, '0130': 0, '0145': 0, '0200': 0, '0215': 0, '0230': 0, '0245': 0, '0300': 0, '0315': 0, '0330': 0, '0345': 0, '0400': 0, '0415': 0, '0430': 0, '0445': 0, '0500': 0, '0515': 0, '0530': 0, '0545': 0, '0600': 0, '0615': 0, '0630': 0, '0645': 0, '0700': 0, '0715': 0, '0730': 0, '0745': 0, '0800': 0, '0815': 0, '0830': 0, '0845': 0, '0900': 0, '0915': 0, '0930': 0, '0945': 0, '1000': 0, '1015': 0, '1030': 0, '1045': 0, '1100': 0, '1115': 0, '1130': 0, '1145': 0, '1200': 0, '1215': 0, '1230': 0, '1245': 0, '1300': 0, '1315': 0, '1330': 0, '1345': 0, '1400': 0, '1415': 0, '1430': 0, '1445': 0, '1500': 0, '1515': 0, '1530': 0, '1545': 0, '1600': 0, '1615': 0, '1630': 0, '1645': 0, '1700': 0, '1715': 0, '1730': 0, '1745': 0, '1800': 0, '1815': 0, '1830': 0, '1845': 0, '1900': 0, '1915': 0, '1930': 0, '1945': 0, '2000': 0, '2015': 0, '2030': 0, '2045': 0, '2100': 0, '2115': 0, '2130': 0, '2145': 0, '2200': 0, '2215': 0, '2230': 0, '2245': 0, '2300': 0, '2315': 0, '2330': 0, '2345': 0},
            'Friday': {'0000': 0, '0015': 0, '0030': 0, '0045': 0, '0100': 0, '0115': 0, '0130': 0, '0145': 0, '0200': 0, '0215': 0, '0230': 0, '0245': 0, '0300': 0, '0315': 0, '0330': 0, '0345': 0, '0400': 0, '0415': 0, '0430': 0, '0445': 0, '0500': 0, '0515': 0, '0530': 0, '0545': 0, '0600': 0, '0615': 0, '0630': 0, '0645': 0, '0700': 0, '0715': 0, '0730': 0, '0745': 0, '0800': 0, '0815': 0, '0830': 0, '0845': 0, '0900': 0, '0915': 0, '0930': 0, '0945': 0, '1000': 0, '1015': 0, '1030': 0, '1045': 0, '1100': 0, '1115': 0, '1130': 0, '1145': 0, '1200': 0, '1215': 0, '1230': 0, '1245': 0, '1300': 0, '1315': 0, '1330': 0, '1345': 0, '1400': 0, '1415': 0, '1430': 0, '1445': 0, '1500': 0, '1515': 0, '1530': 0, '1545': 0, '1600': 0, '1615': 0, '1630': 0, '1645': 0, '1700': 0, '1715': 0, '1730': 0, '1745': 0, '1800': 0, '1815': 0, '1830': 0, '1845': 0, '1900': 0, '1915': 0, '1930': 0, '1945': 0, '2000': 0, '2015': 0, '2030': 0, '2045': 0, '2100': 0, '2115': 0, '2130': 0, '2145': 0, '2200': 0, '2215': 0, '2230': 0, '2245': 0, '2300': 0, '2315': 0, '2330': 0, '2345': 0},
            'Saturday': {'0000': 0, '0015': 0, '0030': 0, '0045': 0, '0100': 0, '0115': 0, '0130': 0, '0145': 0, '0200': 0, '0215': 0, '0230': 0, '0245': 0, '0300': 0, '0315': 0, '0330': 0, '0345': 0, '0400': 0, '0415': 0, '0430': 0, '0445': 0, '0500': 0, '0515': 0, '0530': 0, '0545': 0, '0600': 0, '0615': 0, '0630': 0, '0645': 0, '0700': 0, '0715': 0, '0730': 0, '0745': 0, '0800': 0, '0815': 0, '0830': 0, '0845': 0, '0900': 0, '0915': 0, '0930': 0, '0945': 0, '1000': 0, '1015': 0, '1030': 0, '1045': 0, '1100': 0, '1115': 0, '1130': 0, '1145': 0, '1200': 0, '1215': 0, '1230': 0, '1245': 0, '1300': 0, '1315': 0, '1330': 0, '1345': 0, '1400': 0, '1415': 0, '1430': 0, '1445': 0, '1500': 0, '1515': 0, '1530': 0, '1545': 0, '1600': 0, '1615': 0, '1630': 0, '1645': 0, '1700': 0, '1715': 0, '1730': 0, '1745': 0, '1800': 0, '1815': 0, '1830': 0, '1845': 0, '1900': 0, '1915': 0, '1930': 0, '1945': 0, '2000': 0, '2015': 0, '2030': 0, '2045': 0, '2100': 0, '2115': 0, '2130': 0, '2145': 0, '2200': 0, '2215': 0, '2230': 0, '2245': 0, '2300': 0, '2315': 0, '2330': 0, '2345': 0}
        }
        self.class_schedule = []

    def check_availability(self, sections):
        for section in sections:
            days = section["days"]
            time_slots = section["time_slots"]

            for day in days:
                for time_slot in time_slots:
                    if self.timetable[day][time_slot] != 0:
                        return False
        return True

    def update_timetable(self, sections):
        for section in sections:
            days = section["days"]
            time_slots = section["time_slots"]

            for day in days:
                for time_slot in time_slots:
                    self.timetable[day][time_slot] = 1

    def add_class(self, class_info):
        class_name = list(class_info.keys())[0]
        sections = class_info[class_name]
        
        # Sort sections by day and time
        sections.sort(key=lambda x: (x["days"], x["time_slots"]))
        
        # Find the first available time slot for each section
        for section in sections:
            if self.check_availability([section]):
                self.update_timetable([section])
                self.class_schedule.append({class_name: [section]})
                # print(f"Added {class_name} - {section['section']} to the schedule.")
            else:
                # If the section can't be scheduled, break and move to the next class
                break

    def print_schedule(self):
        print("Final Schedule:")
        for i, entry in enumerate(self.class_schedule, 1):
            for class_name, sections in entry.items():
                section = sections[0]
                print(f"{class_name} - {section['section']} on {', '.join(section['days'])} at {', '.join(section['time_slots'])}")

# Example class schedule
class_schedule_info = [
    {
        "Class 341": [
            {"section": "Section 1", "time_slots": ["1200", "1215", "1230", "1245", "1300", "1315", "1330", "1345", "1400", "1415", "1430"], "days": ["Friday"]},
            {"section": "Section 2", "time_slots": ["0800", "0815", "0830", "0845", "0900", "0915", "0930", "0945", "1000", "1015", "1030"], "days": ["Saturday"]}
            ],
            "Class 325": [
            {"section": "Section 1", "time_slots": ["1800", "1815", "1830", "1845", "1900", "1915"], "days": ["Monday"]},
            {"section": "Section 2", "time_slots": ["1700", "1715", "1730", "1745", "1800", "1815"], "days": ["Tuesday"]}
        ],
        "Class 491A": [
            {"section": "Section 1", "time_slots": ["1400", "1415", "1430", "1445", "1500", "1515"], "days": ["Monday"]},
            {"section": "Section 2", "time_slots": ["1930", "1945", "2000", "2015", "2030", "2045"], "days": ["Tuesday"]},
            {"section": "Section 3", "time_slots": ["1830", "1845", "1900", "1915", "1930", "1945"], "days": ["Monday"]},
            {"section": "Section 4", "time_slots": ["2000", "2015", "2030", "2045", "2100", "2115"], "days": ["Tuesday"]}
        ],
        "Class 326": [
            {"section": "Section 1", "time_slots": ["1700", "1715", "1730", "1745", "1800", "1815"], "days": ["Tuesday"]},
            {"section": "Section 2", "time_slots": ["1400", "1415", "1430", "1445", "1500", "1515"], "days": ["Monday"]}
        ],
        "Class 342": [
            {"section": "Section 1", "time_slots": ["1230", "1245", "1300", "1315", "1330", "1345"], "days": ["Tuesday"]},
            {"section": "Section 2", "time_slots": ["1400", "1415", "1430", "1445", "1500", "1515"], "days": ["Monday"]},
            {"section": "Section 3", "time_slots": ["1300", "1315", "1330", "1345", "1400", "1415", "1430", "1445", "1500", "1515", "1530"], "days": ["Friday"]},
            {"section": "Section 4", "time_slots": ["1800", "1815", "1830", "1845", "1900", "1915"], "days": ["Monday"]},
            {"section": "Section 5", "time_slots": ["0930", "0945", "1000", "1015", "1030", "1045"], "days": ["Tuesday"]},
            {"section": "Section 6", "time_slots": ["0800", "0815", "0830", "0845", "0900", "0915", "0930", "0945", "1000", "1015", "1030", "1045"], "days": ["Friday"]},
            {"section": "Section 7", "time_slots": ["1830", "1845", "1900", "1915", "1930", "1945"], "days": ["Tuesday"]}
        ]
    }
]

planner = SchedulePlanner()
for class_info in class_schedule_info:
    planner.add_class(class_info)

planner.print_schedule()
